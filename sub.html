<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Learning in Audio-visual</title>
    <link rel="stylesheet" href="plugin/bootstrap-5.2.0-dist/css/bootstrap.css">
    <link rel="stylesheet" href="style/jquery-rvnm.css">
    <style>
        header {
            background: transparent;
            box-shadow: 5px 5px 10px #cccccc47;
            -webkit-transition: background 0.5s ease-in-out, padding 0.5s ease-in-out;
            transition: background 0.5s ease-in-out, padding 0.5s ease-in-out;
        }

        header a {
            color: #000000 !important;
        }

        header.text-bg-light {
            background-color: #3f51b5 !important;
        }

        header.text-bg-light a {
            color: white !important;
        }

        header.text-bg-light .dropdown-menu a {
            color: #000000 !important;
        }

        .side-bar {
            margin-top: 0 !important;
            text-align: center;
        }


        .text li {
            margin: 20px 0;
        }

        .offcanvas-body li {
            margin: 5px 0;
        }

        a {
            word-break: break-word;
        }

        .menu-item {
            display: table !important;
            text-align: center;
            width: 100%;
            word-break: break-word;
        }

        .right-content a {
            cursor: pointer;
        }
    </style>
</head>
<body>

<header class="p-3 sticky-top scrolling-navbar">
    <div class="container">
        <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
            <a href="index.html" class="d-flex align-items-center mb-2 mb-lg-0 text-decoration-none"
               style="">
                <img src="img/logo.png" alt="logo" style="width: 40px; height: 40px;border-radius: 50%">
            </a>

            <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0"
                style="padding-left: 30px">
                <li><a href="index.html" class="nav-link px-2 ">Overview</a></li>
                <li class="nav-item dropdown" style="z-index: 99999">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                       aria-expanded="false">
                        Content
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="sub.html?name=Boosting Single Modality Learning">Boosting
                            Single Modality Learning</a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="sub.html?name=Cross-modal Perception">Cross-modal
                            Perception</a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li>
                            <a class="dropdown-item" href="sub.html?name=Audio-visual Collaborative Learning">Audio-visual
                                Collaborative Learning</a></li>
                    </ul>
                </li>
                <li><a href="#" class="nav-link px-2">Github</a></li>
            </ul>

        </div>
    </div>
</header>


<nav id="item_menu" class="rvnm-navbar-box dark-doder sticky-top" style="box-shadow: 5px 5px 10px #cccccc47;">
    <ul>

        <li>
            <span class="spliter menu-item" style="font-size: 28px;color: #3f51b5;"><i class="fa fa-cart-plus"></i>TOC</span>
        </li>
        <!--                    <li class="rvnm-expandable">-->
        <!--                        <a href="#">-->
        <!--                            <i class="fa fa-plus-square"></i> Nunc eleifend molestie velit. Morbi lobortis quam eu velit-->
        <!--                        </a>-->
        <!--                        <ul>-->
        <!--                            <li>-->
        <!--                                <a href="#">-->
        <!--                                    semper leo-->
        <!--                                </a>-->
        <!--                            </li>-->
        <!--                        </ul>-->
        <!--                    </li>-->

    </ul>

</nav>

<div style="padding: 16px 0;width: 100%;margin: auto">
    <div style="background-color: white;border-radius: 10px;margin-left: 220px">
        <div class="right-content img" style="height: calc(100vh);text-align: center">
            <img style="width: 80%;max-width: 1200px;margin: auto" alt="" src=""/>
        </div>
        <div class="right-content text" style="display: none; padding: 30px 50px;border-radius: 10px;"></div>
    </div>
</div>

<div class=" offcanvas offcanvas-bottom" tabindex="-1" id="offcanvas-ref" aria-labelledby="offcanvas-ref-label">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasExampleLabel">References</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body small">

    </div>
</div>

<script src="script/jquery-3.6.0.min.js"></script>
<script src="plugin/popper.min.js"></script>
<script src="plugin/bootstrap-5.2.0-dist/js/bootstrap.js"></script>
<script src="script/jquery-rvnm.js"></script>

<script type="application/javascript">
    (function ($) {
        $.getUrlParam = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]);
            return null;
        }
    })(jQuery);
    const re = /\[((\d+),?)+]/g
    $(function () {
        $("header").addClass("text-bg-light");
        // $(document)
        //     .off("scroll")
        //     .on("scroll", function () {
        //         const top = $(this).scrollTop();
        //         // header变色
        //         if (top > 50) {
        //             $("header").addClass("text-bg-light");
        //         } else {
        //             $("header").removeClass("text-bg-light");
        //         }
        //     });


        const page = {
            "Boosting Single Modality Learning": [
                [
                    "Speech Recognition",
                    "Speaker Recognition",
                    "Action Recognition",
                    "Emotion Recognition",
                ],
                [
                    "Speech Enhancement and Separation",
                    "Object Sound Separation",
                    "Face Super-resolution and Reconstruction",
                ]
            ],
            "Cross-modal Perception": [
                [
                    "Mono Sound Generation",
                    "Spatial Sound Generation",
                    "Video Generation",
                    "Depth Estimation",
                ],
                "Audio-visual Transfer Learning",
                "Cross-modal Retrieval",
            ],
            "Audio-visual Collaborative Learning": [
                [
                    "Audio-visual Consistency",
                    "Deep Clustering",
                    "Pre-training Models",
                ],

                [
                    "Sound Localization in Videos",
                    "Audio-visual Saliency Detection",
                    "Audio-visual Navigation",
                ],
                "Audio-visual Event Localization and Parsing",
                "Audio-visual Question Answering and Dialog",
            ],

        };
        const colors = ["#0450b4", "#c2031a", "#03c2b2", "#ba4702",]
        const page_name = $.getUrlParam('name');
        const item_arr = page[page_name];
        let $append = $("#item_menu ul");
        let id_index = 0;
        for (let i = 0; i < item_arr.length; i++) {
            const color = colors[i % colors.length];
            let item = item_arr[i];
            if (!(item instanceof Array)) {
                item = [item];
            }
            let $dom = null;
            for (const text of item) {
                $dom = $('<li class=""><a class="menu-item"> <i class="fa fa-bullhorn"></i></a></li>');
                let $dom_a = $dom.find(".menu-item");
                $dom_a.css('color', color);

                $dom_a.text(text);
                $dom_a.data("name", text);
                $append.append($dom);

            }
            if ($dom !== null && i !== item_arr.length - 1) {
                $dom.append("<hr style='margin: 0;height: 2px;background: black;'>")
            }
        }
        $("#item_menu").rvnm();

        $(".right-content.img img").attr("src", "content/" + page_name + "/image.jpg");
        $(".title .lead").text(page_name)
        $("title").text(page_name)

        refs = {};

        $(document)
            .off("click", ".menu-item")
            .on("click", ".menu-item", function () {
                const $this = $(this);
                const name = $this.data("name");
                if (typeof(name) === "undefined"){
                    $(".right-content.text").hide();
                    $(".right-content.img").show();
                    return;
                }
                $.get("content/" + page_name + "/" + name + ".txt", function (data) {
                    const $append = $("<div></div>")
                    $append.append('<h1 style="margin-bottom: 60px">' + name + '</h1>')
                    const split = data.split("\n");
                    console.debug(data)
                    for (let line of split) {
                        if (line.startsWith("##")) {
                            let $dom = $("<li></li>");

                            $dom.html(line.replaceAll(/(\[(((\d+),?)+)])/g, "<a class='ref'>$1</a>").substr(2));
                            $append.append($dom);
                        } else if (line.startsWith("#")) {
                            $append.append($("<h3></h3>").text(line.substr(1)));
                        } else if (line.startsWith("[")) {
                            let num = line.match(/^\[(\d+)]/)[1];
                            refs[num] = line;
                        }
                    }
                    $(".right-content.text").html($append)
                }).fail(function (data) {
                    $(".right-content.text").html("<div class=\"alert alert-danger\" role=\"alert\">\n" +
                        "error: " + data.status +
                        "</div>")
                })


                $(".right-content.img").hide();
                $(".right-content.text").show();
                console.log(name)

            })
            .off("click", ".ref")
            .on("click", ".ref", function () {
                const $this = $(this);
                const text = $this.text();
                const ref_nums = text.substr(1, text.length - 2).split(",");
                const $offcanvas_ref = $("#offcanvas-ref");
                const $dom = $("<ul></ul>");
                for (const item of ref_nums) {
                    $dom.append("<li>" + refs[item].replaceAll(/\((.*?)\)/g, "(<a href='$1' target='_blank'>$1</a>)") + "</li>")
                }
                $offcanvas_ref.find(".offcanvas-body").html($dom);
                $offcanvas_ref.offcanvas("show");
                console.log(ref_nums)
            })
        ;
    });
</script>
</body>
</html>