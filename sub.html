<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Learning in Audio-visual</title>
    <link rel="stylesheet" href="plugin/bootstrap-5.2.0-dist/css/bootstrap.css">
    <link rel="stylesheet" href="style/jquery-rvnm.css">
    <style>
        .side-bar {
            margin-top: 0 !important;
            text-align: center;
        }


        .text li {
            margin: 20px 0;
        }

        .offcanvas-body li {
            margin: 5px 0;
        }

        a {
            word-break: break-all;
        }

        .menu-item {
            display: table !important;
            text-align: center;
            width: 100%;
            word-break: break-word;
        }

        .right-content a {
            cursor: pointer;
        }
    </style>
</head>
<body>

<header class="p-3 text-bg-dark" style="/* background: transparent !important; */box-shadow: 5px 5px 10px #777;">
    <div class="container">
        <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
            <a href="index.html" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none"
               style="">
                <img src="img/logo.png" alt="logo" style="width: 40px; height: 40px;border-radius: 50%">
            </a>

            <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
                <li><a href="index.html" class="nav-link px-2 text-white">Full Survey</a></li>
                <li class="nav-item dropdown" style="z-index: 99999">
                    <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="dropdown"
                       aria-expanded="false">
                        Content
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="sub.html?name=Boosting Single Modality Learning">Boosting
                            Single Modality Learning</a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="sub.html?name=Cross-modal Perception">Cross-modal
                            Perception</a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li>
                            <a class="dropdown-item" href="sub.html?name=Audio-visual Collaborative Learning">Audio-visual
                                Collaborative Learning</a></li>
                    </ul>
                </li>
                <li><a href="#" class="nav-link px-2 text-white">Github</a></li>
            </ul>

        </div>
    </div>
</header>


<div class="container" style="padding: 16px 0;width: 100%;margin: 0">


    <div class="row g-3">
        <div class="col-md-4 col-lg-3 side-bar">
            <!--            <div id="item_menu" class="sticky-top btn-group-vertical" role="group"-->
            <!--                 aria-label="Vertical radio toggle button group"-->
            <!--                 style="line-height: 100px;background-color:#fff;width: 100%;border-radius: 10px">-->
            <!--            </div>-->
            <nav id="item_menu" class="rvnm-navbar-box dark-ruby sticky-top" style="padding-bottom: 20px;">
                <ul>

                    <li>
                        <span class="spliter"><i class="fa fa-cart-plus"></i>menu</span>
                    </li>
                    <!--                    <li class="rvnm-expandable">-->
                    <!--                        <a href="#">-->
                    <!--                            <i class="fa fa-plus-square"></i> Nunc eleifend molestie velit. Morbi lobortis quam eu velit-->
                    <!--                        </a>-->
                    <!--                        <ul>-->
                    <!--                            <li>-->
                    <!--                                <a href="#">-->
                    <!--                                    semper leo-->
                    <!--                                </a>-->
                    <!--                            </li>-->
                    <!--                        </ul>-->
                    <!--                    </li>-->

                </ul>

            </nav>

        </div>
        <div class="col-md-9 col-lg-9"
             style="background-color: white;margin-top:16px;border-radius: 10px;min-height: calc(100vh)">
            <div class="right-content img">
                <img style="width: 80%" alt="" src=""/>
            </div>
            <div class="right-content text" style="display: none; padding: 10px 20px;border-radius: 10px;"></div>
        </div>
    </div>
</div>

<div class=" offcanvas offcanvas-bottom" tabindex="-1" id="offcanvas-ref" aria-labelledby="offcanvas-ref-label">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasExampleLabel">References</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body small">

    </div>
</div>

<script src="script/jquery-3.6.0.min.js"></script>
<script src="plugin/popper.min.js"></script>
<script src="plugin/bootstrap-5.2.0-dist/js/bootstrap.js"></script>
<script src="script/jquery-rvnm.js"></script>

<script type="application/javascript">
    (function ($) {
        $.getUrlParam = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]);
            return null;
        }
    })(jQuery);
    var re = /\[((\d+),?)+]/g
    $(function () {
        const page = {
            "Boosting Single Modality Learning": [
                [
                    "Speech Recognition",
                    "Speaker Recognition",
                    "Action Recognition",
                    "Emotion Recognition",
                ],
                [
                    "Speech Enhancement and Separation",
                    "Object Sound Separation",
                    "Face Super-resolution and Reconstruction",
                ]
            ],
            "Cross-modal Perception": [
                [
                    "Mono Sound Generation",
                    "Spatial Sound Generation",
                    "Video Generation",
                    "Depth Estimation",
                ],
                "Audio-visual Transfer Learning",
                "Cross-modal Retrieval",
            ],
            "Audio-visual Collaborative Learning": [
                [
                    "Audio-visual Consistency",
                    "Deep Clustering",
                    "Pre-training Models",
                ],

                [
                    "Sound Localization in Videos",
                    "Audio-visual Saliency Detection",
                    "Audio-visual Navigation",
                ],
                "Audio-visual Event Localization and Parsing",
                "Audio-visual Question Answering and Dialog",
            ],

        };
        const colors = ["#d6e8ff", "#ffd0d5", "#cbfdf8", "#ffdcc6",]
        const page_name = $.getUrlParam('name');
        const item_arr = page[page_name];
        let $append = $("#item_menu ul");
        let id_index = 0;
        for (let i = 0; i < item_arr.length; i++) {
            const color = colors[i % colors.length];
            let item = item_arr[i];
            if (!(item instanceof Array)) {
                item = [item];
            }
            for (const text of item) {
                // let $dom_radio = $("<input type=\"radio\" class=\"btn-check\" name=\"vbtn-radio\" autocomplete=\"off\">")
                // let $dom_label = $("<label class=\"btn \" style=';text-decoration: underline;text-align: left;margin: 1px auto; color: " + color + "'></label>")
                // let id = "vbtn-radio" + id_index++;
                // $dom_radio.attr("id", id);
                // $dom_label.attr("for", id);
                // $dom_label.text(text);
                // $dom_label.data("name", text);
                // $append.append($dom_radio);
                // $append.append($dom_label);

                let $dom = $('<li class=""><a class="menu-item"> <i class="fa fa-bullhorn"></i></a></li>');
                let $dom_a = $dom.find(".menu-item");
                $dom_a.css('color', color);

                $dom_a.text(text);
                $dom_a.data("name", text);
                $append.append($dom);

            }
            $append.append("<hr>")
        }
        $("#item_menu").rvnm();

        $(".right-content.img img").attr("src", "content/" + page_name + "/image.jpg");
        $(".title .lead").text(page_name)
        $("title").text(page_name)

        refs = {};

        $(document)
            .off("click", ".menu-item")
            .on("click", ".menu-item", function () {
                const $this = $(this);
                const name = $this.data("name");
                $.get("content/" + page_name + "/" + name + ".txt", function (data) {
                    const $append = $("<div></div>")
                    const split = data.split("\n");
                    console.debug(data)
                    for (let line of split) {
                        if (line.startsWith("##")) {
                            let $dom = $("<li></li>");

                            $dom.html(line.replaceAll(/(\[(((\d+),?)+)])/g, "<a class='ref'>$1</a>").substr(2));
                            $append.append($dom);
                        } else if (line.startsWith("#")) {
                            $append.append($("<h2></h2>").text(line.substr(1)));
                        } else if (line.startsWith("[")) {
                            let num = line.match(/^\[(\d+)]/)[1];
                            refs[num] = line;
                        }
                    }
                    $(".right-content.text").html($append)
                }).fail(function (data) {
                    $(".right-content.text").html("<div class=\"alert alert-danger\" role=\"alert\">\n" +
                        "error: " + data.status +
                        "</div>")
                })


                $(".right-content.img").hide();
                $(".right-content.text").show();
                console.log(name)

            })
            .off("click", ".ref")
            .on("click", ".ref", function () {
                const $this = $(this);
                const text = $this.text();
                const ref_nums = text.substr(1, text.length - 2).split(",");
                const $offcanvas_ref = $("#offcanvas-ref");
                const $dom = $("<ul></ul>");
                for (const item of ref_nums) {
                    $dom.append("<li>" + refs[item].replaceAll(/\((.*?)\)/g, "(<a href='$1' target='_blank'>$1</a>)") + "</li>")
                }
                $offcanvas_ref.find(".offcanvas-body").html($dom);
                $offcanvas_ref.offcanvas("show");
                console.log(ref_nums)
            })
        ;
    });
</script>
</body>
</html>